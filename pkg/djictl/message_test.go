package djictl

import (
	"encoding/hex"
	"testing"

	"github.com/stretchr/testify/require"
)

func TestParseMessage(t *testing.T) {
	b, err := hex.DecodeString("553304C20207928040074500203238346165356238643736623333373561303461363431376164373162656133046D626C6E8FA3")
	require.NoError(t, err)

	msg, err := ParseMessage(b)
	require.NoError(t, err)
	require.Equal(t, &Message{
		Subsystem: SubsystemIDPairer,
		ID:        MessageIDSetPairingPIN,
		Type:      MessageTypeSetPairingPIN,
		Payload: []uint8{
			0x20, 0x32, 0x38, 0x34, 0x61, 0x65, 0x35, 0x62, 0x38, 0x64, 0x37, 0x36, 0x62, 0x33, 0x33, 0x37, 0x35, 0x61, 0x30, 0x34, 0x61, 0x36, 0x34, 0x31, 0x37, 0x61, 0x64, 0x37, 0x31, 0x62, 0x65, 0x61, 0x33, 0x4, 0x6d, 0x62, 0x6c, 0x6e,
		},
	}, msg)
}
